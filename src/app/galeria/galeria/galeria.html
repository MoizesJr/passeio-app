<form #frm="ngForm" class="max-w-6xl mx-auto mb-10 px-6 animate-fade-in">
  <div class="bg-black/60 backdrop-blur-xl p-6 rounded-[2.5rem] border border-white/10 shadow-2xl"> 
    <div class="flex flex-col md:flex-row items-center justify-center gap-4">
      
      <div class="relative w-full">
        <span class="absolute left-4 top-1/2 -translate-y-1/2 text-white/40">üîç</span>
        <input type="text" 
               name="nomeFiltro"
               [(ngModel)]="nomeFiltro"
               placeholder="Para onde quer ir?" 
               class="w-full bg-white/10 border border-white/20 p-4 pl-12 rounded-2xl text-white placeholder:text-white/40 focus:ring-2 focus:ring-yellow-400 outline-none transition-all shadow-inner"/>
      </div>

      <select name="categoriaFiltro"
              [(ngModel)]="categoriaFiltro"
              class="w-full md:w-80 bg-white/10 border border-white/20 p-4 rounded-2xl text-white outline-none focus:ring-2 focus:ring-yellow-400 transition-all appearance-none cursor-pointer">
        <option value="-1" class="bg-gray-900 text-white">Todas as categorias</option>
        <option *ngFor="let categoria of categoriasFiltro" [value]="categoria.nome" class="bg-gray-900 text-white">
          {{ categoria.nome }}
        </option> 
      </select>

      <button type="button"
              (click)="filtrar()"
              class="w-full md:w-auto bg-yellow-400 text-black px-10 py-4 rounded-2xl shadow-lg hover:bg-yellow-300 hover:scale-[1.03] transition-all font-black uppercase tracking-widest active:scale-95">
        Pesquisar
      </button>
    </div>
  </div>
</form>

<div id="lugaresList" class="max-w-7xl mx-auto p-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">

  <div *ngFor="let lugar of lugares" 
       class="group relative bg-white/10 backdrop-blur-md border border-white/20 rounded-[2.5rem] overflow-hidden shadow-2xl transition-all duration-500 hover:-translate-y-3 flex flex-col h-full">
    
    <div class="relative h-60 overflow-hidden bg-white/5">
      <img [src]="lugar.urlFoto" 
           [alt]="lugar.nome" 
           loading="lazy"
           class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700 opacity-0"
           (load)="img.classList.remove('opacity-0')"
           #img />
      
      <div class="absolute top-4 right-4 bg-yellow-400 text-black px-3 py-1 rounded-full shadow-xl">
        <span class="text-[10px] font-black uppercase tracking-widest">
          {{ lugar.categoria?.nome }}
        </span>
      </div>
    </div>
    
    <div class="p-6 flex-grow text-center">
      <h2 class="text-2xl font-black text-white mb-1 drop-shadow-md">
        {{ lugar.nome }}
      </h2>
      
      <p class="text-yellow-400 flex items-center justify-center gap-1 text-xs font-bold uppercase tracking-tighter mb-4">
        üìç {{ lugar.localizacao }}
      </p>
      
      <div class="bg-black/20 backdrop-blur-sm p-3 rounded-2xl border border-white/5 inline-flex flex-col items-center">
        <div class="flex items-center gap-1">
          <span class="text-yellow-400 text-sm" [innerHTML]="getTotalEstrelas(lugar)"></span>
          <span class="text-white/80 text-[10px] font-bold">({{ lugar.avaliacao }}/5)</span>
        </div>
        <span class="text-[8px] text-white/40 font-black uppercase tracking-[0.2em] mt-1">Avalia√ß√£o dos Clientes</span>
      </div>
    </div>

    <div class="p-6 pt-0 mt-auto">
      <a [href]="'https://api.whatsapp.com/send?phone=5581988887777&text=Ol√°! Quero negociar o passeio em ' + lugar.nome"
         target="_blank"
         class="flex items-center justify-center w-full bg-white text-gray-900 font-black py-4 px-4 rounded-2xl hover:bg-yellow-400 hover:scale-[1.02] transition-all duration-300 gap-3 shadow-xl active:scale-95 group/btn">
        
        <span class="text-xl group-hover/btn:rotate-12 transition-transform">üö§</span>
        <span class="tracking-widest text-xs">RESERVAR PASSEIO</span>
      </a>
    </div>

  </div>
</div>